<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CASTING - 영화 프로젝트 관리</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>영화 프로젝트 관리 시스템</h1>
        </header>

        <main>
            <!-- 프로젝트 목록 섹션 -->
            <section id="projectListSection" class="view-section active">
                <div class="section-header">
                    <h2>프로젝트 목록</h2>
                    <button id="createProjectBtn" class="btn btn-primary">+ 새 프로젝트 생성</button>
                </div>
                <div id="projectList" class="project-list">
                    <p class="empty-message">생성된 프로젝트가 없습니다.</p>
                </div>
            </section>

            <!-- 프로젝트 상세 관리 섹션 -->
            <section id="projectDetailSection" class="view-section">
                <div class="detail-header">
                    <button id="backToListBtn" class="btn-back">
                        <span>←</span> 목록으로 돌아가기
                    </button>
                    <div class="detail-title-group">
                        <h2 id="detailProjectName">프로젝트 상세 관리</h2>
                        <p id="detailProjectDescription" class="project-subtitle"></p>
                    </div>
                </div>
                
                <div class="tabs">
                    <button class="tab-btn active" data-tab="schedule">스케줄</button>
                    <button class="tab-btn" data-tab="staff">스태프</button>
                    <button class="tab-btn" data-tab="actor">배우</button>
                    <button class="tab-btn" data-tab="budget">예산</button>
                    <button class="tab-btn" data-tab="contract">계약서</button>
                </div>

                <!-- 스케줄 관리 탭 -->
                <div id="scheduleTab" class="tab-content active">
                    <div class="tab-header">
                        <h3>스케줄 관리</h3>
                        <div class="tab-actions">
                            <div class="search-box">
                                <input type="text" id="scheduleSearchInput" placeholder="스케줄 검색 (제목, 장소, 설명, 날짜)" />
                            </div>
                            <div class="view-toggle">
                                <button class="view-toggle-btn" data-view="list" title="리스트 뷰">
                                    <span>📋</span>
                                </button>
                                <button class="view-toggle-btn active" data-view="calendar" title="캘린더 뷰">
                                    <span>📅</span>
                                </button>
                            </div>
                            <button id="addScheduleBtn" class="btn btn-primary">+ 스케줄 추가</button>
                        </div>
                    </div>
                    <!-- 스케줄 리스트 뷰 -->
                    <div id="scheduleListView" class="schedule-view">
                        <div id="scheduleList" class="management-list">
                            <p class="empty-message">등록된 스케줄이 없습니다.</p>
                        </div>
                    </div>
                    <!-- 스케줄 캘린더 뷰 -->
                    <div id="scheduleCalendarView" class="schedule-view active">
                        <div class="calendar-header">
                            <div class="calendar-header-left">
                                <button id="prevMonthBtn" class="btn btn-icon">‹</button>
                                <button id="nextMonthBtn" class="btn btn-icon">›</button>
                                <button id="todayBtn" class="btn btn-secondary btn-today">오늘</button>
                            </div>
                            <h4 id="calendarMonthYear"></h4>
                        </div>
                        <div id="calendarContainer" class="calendar-container">
                            <div class="calendar-weekdays">
                                <div class="calendar-weekday">일</div>
                                <div class="calendar-weekday">월</div>
                                <div class="calendar-weekday">화</div>
                                <div class="calendar-weekday">수</div>
                                <div class="calendar-weekday">목</div>
                                <div class="calendar-weekday">금</div>
                                <div class="calendar-weekday">토</div>
                            </div>
                            <div id="calendarDays" class="calendar-days"></div>
                        </div>
                    </div>
                </div>

                <!-- 스태프 관리 탭 -->
                <div id="staffTab" class="tab-content">
                    <div class="tab-header">
                        <h3>스태프 관리</h3>
                        <div class="tab-actions">
                            <div class="search-box">
                                <input type="text" id="staffSearchInput" placeholder="스태프 검색 (이름, 역할, 연락처, 이메일)" />
                            </div>
                            <button id="importStaffBtn" class="btn btn-secondary">📥 Google 시트에서 가져오기</button>
                            <button id="addStaffBtn" class="btn btn-primary">스태프 추가</button>
                        </div>
                    </div>
                    <div id="staffList" class="management-list">
                        <p class="empty-message">등록된 스태프가 없습니다.</p>
                    </div>
                </div>

                <!-- 배우 관리 탭 -->
                <div id="actorTab" class="tab-content">
                    <div class="tab-header">
                        <h3>배우 관리</h3>
                        <div class="tab-actions">
                            <div class="search-box">
                                <input type="text" id="actorSearchInput" placeholder="배우 검색 (이름, 역할, 연락처, 이메일)" />
                            </div>
                            <button id="importActorBtn" class="btn btn-secondary">📥 Google 시트에서 가져오기</button>
                            <button id="addActorBtn" class="btn btn-primary">배우 추가</button>
                        </div>
                    </div>
                    <div id="actorList" class="management-list">
                        <p class="empty-message">등록된 배우가 없습니다.</p>
                    </div>
                </div>
                
                <!-- 예산 관리 탭 -->
                <div id="budgetTab" class="tab-content">
                    <div class="tab-header">
                        <h3>예산 관리</h3>
                        <div class="tab-actions">
                            <button id="setTotalBudgetBtn" class="btn btn-secondary">전체 예산 설정</button>
                            <button id="addExpenseBtn" class="btn btn-primary">비용 사용 기록</button>
                        </div>
                    </div>
                    
                    <div id="budgetSummary" class="budget-summary">
                        <div class="budget-card total">
                            <h4>전체 예산</h4>
                            <p id="totalBudgetAmount">-</p>
                        </div>
                        <div class="budget-card used">
                            <h4>사용한 비용</h4>
                            <p id="usedBudgetAmount">-</p>
                        </div>
                        <div class="budget-card remaining">
                            <h4>남은 예산</h4>
                            <p id="remainingBudgetAmount">-</p>
                        </div>
                    </div>
                    
                    <div id="expenseList" class="management-list">
                        <p class="empty-message">등록된 비용 내역이 없습니다.</p>
                    </div>
                </div>

                <!-- 계약서 관리 탭 -->
                <div id="contractTab" class="tab-content">
                    <div class="tab-header">
                        <h3>계약서 관리</h3>
                        <div class="tab-actions">
                            <div class="search-box">
                                <input type="text" id="contractSearchInput" placeholder="계약서 검색 (인력명, 로케이션, 차량, 제목, 메모)" />
                            </div>
                            <button id="addContractBtn" class="btn btn-primary">계약서 추가</button>
                        </div>
                    </div>
                    <div id="contractList" class="contract-list-grouped">
                        <!-- 인력 계약서 섹션 -->
                        <div class="contract-section">
                            <div class="contract-section-header" onclick="toggleContractSection('person')">
                                <span class="contract-section-icon">👥</span>
                                <h4>인력 계약서</h4>
                                <span class="contract-section-count" id="personContractCount">0</span>
                                <span class="contract-section-toggle" id="personContractToggle">▼</span>
                            </div>
                            <div class="contract-section-content" id="personContractContent">
                                <div class="management-list" id="personContractList">
                                    <p class="empty-message">등록된 인력 계약서가 없습니다.</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 로케이션 계약서 섹션 -->
                        <div class="contract-section">
                            <div class="contract-section-header" onclick="toggleContractSection('location')">
                                <span class="contract-section-icon">📍</span>
                                <h4>로케이션 계약서</h4>
                                <span class="contract-section-count" id="locationContractCount">0</span>
                                <span class="contract-section-toggle" id="locationContractToggle">▼</span>
                            </div>
                            <div class="contract-section-content" id="locationContractContent">
                                <div class="management-list" id="locationContractList">
                                    <p class="empty-message">등록된 로케이션 계약서가 없습니다.</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 차량 계약서 섹션 -->
                        <div class="contract-section">
                            <div class="contract-section-header" onclick="toggleContractSection('vehicle')">
                                <span class="contract-section-icon">🚗</span>
                                <h4>차량 계약서</h4>
                                <span class="contract-section-count" id="vehicleContractCount">0</span>
                                <span class="contract-section-toggle" id="vehicleContractToggle">▼</span>
                            </div>
                            <div class="contract-section-content" id="vehicleContractContent">
                                <div class="management-list" id="vehicleContractList">
                                    <p class="empty-message">등록된 차량 계약서가 없습니다.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- 모달: 프로젝트 생성/수정 -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="projectModalTitle">새 프로젝트 생성</h3>
            <form id="projectForm" class="project-form">
                <input type="hidden" id="projectId" name="projectId">
                <div class="form-group">
                    <label for="projectName">프로젝트 이름</label>
                    <input type="text" id="projectName" name="projectName" required>
                </div>
                <div class="form-group">
                    <label for="projectDescription">프로젝트 설명</label>
                    <textarea id="projectDescription" name="projectDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="projectStartDate">시작일</label>
                    <input type="date" id="projectStartDate" name="projectStartDate" required>
                </div>
                <div class="form-group">
                    <label for="projectEndDate">종료일</label>
                    <input type="date" id="projectEndDate" name="projectEndDate" required>
                </div>
                <button type="submit" class="btn btn-primary">프로젝트 생성</button>
            </form>
        </div>
    </div>

    <!-- 모달: 스케줄 추가/수정 -->
    <div id="scheduleModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="scheduleModalTitle">스케줄 추가</h3>
            <form id="scheduleForm">
                <input type="hidden" id="scheduleId">
                <div class="form-group">
                    <label for="scheduleTitle">제목</label>
                    <input type="text" id="scheduleTitle" required>
                </div>
                <div class="form-group">
                    <label for="scheduleDate">날짜</label>
                    <input type="date" id="scheduleDate" required>
                </div>
                <div class="form-group">
                    <label for="scheduleTime">시간</label>
                    <input type="time" id="scheduleTime" required>
                </div>
                <div class="form-group">
                    <label for="scheduleLocation">장소</label>
                    <input type="text" id="scheduleLocation">
                </div>
                <div class="form-group">
                    <label for="scheduleDescription">설명</label>
                    <textarea id="scheduleDescription" rows="3"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">저장</button>
            </form>
        </div>
    </div>

    <!-- 모달: 스태프 추가/수정 -->
    <div id="staffModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="staffModalTitle">스태프 추가</h3>
            <form id="staffForm">
                <input type="hidden" id="staffId">
                <div class="form-group">
                    <label for="staffName">이름</label>
                    <input type="text" id="staffName" required>
                </div>
                <div class="form-group">
                    <label for="staffRole">역할</label>
                    <input type="text" id="staffRole" required>
                </div>
                <div class="form-group">
                    <label for="staffContact">연락처</label>
                    <input type="text" id="staffContact">
                </div>
                <div class="form-group">
                    <label for="staffEmail">이메일</label>
                    <input type="email" id="staffEmail">
                </div>
                <button type="submit" class="btn btn-primary">저장</button>
            </form>
        </div>
    </div>

    <!-- 모달: 배우 추가/수정 -->
    <div id="actorModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="actorModalTitle">배우 추가</h3>
            <form id="actorForm">
                <input type="hidden" id="actorId">
                <div class="form-group">
                    <label for="actorName">이름</label>
                    <input type="text" id="actorName" required>
                </div>
                <div class="form-group">
                    <label for="actorImage">프로필 이미지</label>
                    <input type="file" id="actorImage" accept="image/*">
                    <small>이미지를 선택하면 배우 목록에 프로필 사진이 함께 표시됩니다.</small>
                    <div id="actorImagePreviewContainer" class="image-preview" style="display:none;">
                        <img id="actorImagePreview" src="" alt="배우 이미지 미리보기">
                    </div>
                </div>
                <div class="form-group">
                    <label for="actorRole">역할</label>
                    <input type="text" id="actorRole" required>
                </div>
                <div class="form-group">
                    <label for="actorContact">연락처</label>
                    <input type="text" id="actorContact">
                </div>
                <div class="form-group">
                    <label for="actorEmail">이메일</label>
                    <input type="email" id="actorEmail">
                </div>
                <button type="submit" class="btn btn-primary">저장</button>
            </form>
        </div>
    </div>

    <!-- 모달: 전체 예산 설정 -->
    <div id="budgetTotalModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>전체 예산 설정</h3>
            <form id="budgetTotalForm">
                <div class="form-group">
                    <label for="totalBudgetInput">전체 예산 (원)</label>
                    <input type="number" id="totalBudgetInput" min="0" step="1000" required>
                </div>
                <button type="submit" class="btn btn-primary">저장</button>
            </form>
        </div>
    </div>

    <!-- 모달: 비용 사용 기록 추가/수정 -->
    <div id="expenseModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="expenseModalTitle">비용 사용 기록</h3>
            <form id="expenseForm">
                <input type="hidden" id="expenseId">
                <div class="form-group">
                    <label for="expenseTitle">항목</label>
                    <input type="text" id="expenseTitle" required>
                </div>
                <div class="form-group">
                    <label for="expenseAmount">금액 (원)</label>
                    <input type="number" id="expenseAmount" min="0" step="1000" required>
                </div>
                <div class="form-group">
                    <label for="expenseDate">사용일</label>
                    <input type="date" id="expenseDate" required>
                </div>
                <div class="form-group">
                    <label for="expenseMemo">메모</label>
                    <textarea id="expenseMemo" rows="2" placeholder="간단한 설명을 입력하세요."></textarea>
                </div>
                <button type="submit" class="btn btn-primary">저장</button>
            </form>
        </div>
    </div>

    <!-- 모달: 계약서 추가/수정 -->
    <div id="contractModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="contractModalTitle">계약서 추가</h3>
            <form id="contractForm">
                <input type="hidden" id="contractId">
                <div class="form-group">
                    <label for="contractType">계약서 유형</label>
                    <select id="contractType" required>
                        <option value="">선택하세요</option>
                        <option value="person">인력 (배우/스태프)</option>
                        <option value="location">로케이션</option>
                        <option value="vehicle">차량</option>
                    </select>
                </div>
                <!-- 인력 관련 필드 -->
                <div id="contractPersonFields" style="display: none;">
                    <div class="form-group">
                        <label for="contractPersonType">인력 유형</label>
                        <select id="contractPersonType">
                            <option value="">선택하세요</option>
                            <option value="actor">배우</option>
                            <option value="staff">스태프</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="contractPersonId">인력 선택</label>
                        <select id="contractPersonId">
                            <option value="">인력 유형을 먼저 선택하세요</option>
                        </select>
                    </div>
                </div>
                <!-- 로케이션 관련 필드 -->
                <div id="contractLocationFields" style="display: none;">
                    <div class="form-group">
                        <label for="contractLocationName">로케이션 이름</label>
                        <input type="text" id="contractLocationName" placeholder="예: 서울시 강남구 촬영장">
                    </div>
                    <div class="form-group">
                        <label for="contractLocationAddress">주소</label>
                        <input type="text" id="contractLocationAddress" placeholder="상세 주소를 입력하세요">
                    </div>
                </div>
                <!-- 차량 관련 필드 -->
                <div id="contractVehicleFields" style="display: none;">
                    <div class="form-group">
                        <label for="contractVehicleName">차량 정보</label>
                        <input type="text" id="contractVehicleName" placeholder="예: 현대 그랜저 (123가4567)">
                    </div>
                    <div class="form-group">
                        <label for="contractVehicleType">차량 유형</label>
                        <select id="contractVehicleType">
                            <option value="">선택하세요</option>
                            <option value="sedan">승용차</option>
                            <option value="suv">SUV</option>
                            <option value="van">밴</option>
                            <option value="truck">트럭</option>
                            <option value="bus">버스</option>
                            <option value="other">기타</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="contractTitle">계약서 제목</label>
                    <input type="text" id="contractTitle" required>
                </div>
                <div class="form-group">
                    <label for="contractDate">계약일</label>
                    <input type="date" id="contractDate" required>
                </div>
                <div class="form-group">
                    <label for="contractExpiryDate">만료일</label>
                    <input type="date" id="contractExpiryDate">
                </div>
                <div class="form-group">
                    <label for="contractFile">계약서 파일</label>
                    <input type="file" id="contractFile" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx">
                    <small style="color: #6a737d; font-size: 0.75rem;">PDF, 이미지, 문서 파일을 업로드할 수 있습니다.</small>
                </div>
                <div id="contractFilePreviewContainer" class="form-group" style="display: none;">
                    <label>파일 미리보기</label>
                    <div id="contractFilePreview" class="file-preview"></div>
                </div>
                <div class="form-group">
                    <label for="contractMemo">메모</label>
                    <textarea id="contractMemo" rows="3" placeholder="계약서에 대한 추가 정보를 입력하세요."></textarea>
                </div>
                <button type="submit" class="btn btn-primary">저장</button>
            </form>
        </div>
    </div>

    <!-- 모달: Google 스프레드시트 가져오기 -->
    <div id="importSheetModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="importSheetModalTitle">Google 스프레드시트에서 가져오기</h3>
            <div style="margin-bottom: 1rem; padding: 1rem; background: #fff5b1; border: 1px solid #e1e4e8; border-radius: 3px;">
                <p style="margin: 0 0 0.5rem 0; font-size: 0.875rem; font-weight: 600;">사용 방법:</p>
                <ol style="margin: 0; padding-left: 1.5rem; font-size: 0.875rem; color: #586069;">
                    <li>Google 스프레드시트를 "웹에 게시"로 설정하세요</li>
                    <li>스프레드시트 URL을 아래에 붙여넣으세요</li>
                    <li>CSV 형식으로 자동 변환되어 가져옵니다</li>
                </ol>
            </div>
            <form id="importSheetForm">
                <input type="hidden" id="importType" value="">
                <div class="form-group">
                    <label for="sheetUrl">Google 스프레드시트 URL</label>
                    <input type="url" id="sheetUrl" placeholder="https://docs.google.com/spreadsheets/d/..." required>
                    <small style="color: #6a737d; font-size: 0.75rem;">스프레드시트의 공유 링크를 입력하세요</small>
                </div>
                <div class="form-group">
                    <label for="sheetMapping">컬럼 매핑 (선택사항)</label>
                    <div style="font-size: 0.875rem; color: #586069; margin-bottom: 0.5rem;">
                        <p style="margin: 0 0 0.25rem 0;">스프레드시트의 첫 번째 행이 헤더인 경우, 아래에서 매핑할 수 있습니다:</p>
                    </div>
                    <div id="columnMapping" style="display: none;">
                        <!-- 동적으로 생성됨 -->
                    </div>
                    <small style="color: #6a737d; font-size: 0.75rem;">자동 감지되지만, 필요시 수동으로 매핑할 수 있습니다</small>
                </div>
                <div id="importPreview" style="display: none; margin-bottom: 1rem;">
                    <label>미리보기 (최대 5개 행)</label>
                    <div style="max-height: 200px; overflow-y: auto; border: 1px solid #e1e4e8; border-radius: 3px; padding: 0.5rem; background: #f6f8fa; font-size: 0.75rem;">
                        <table id="previewTable" style="width: 100%; border-collapse: collapse;">
                            <!-- 동적으로 생성됨 -->
                        </table>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">가져오기</button>
                <button type="button" class="btn btn-secondary" onclick="closeModal('importSheetModal')" style="margin-left: 0.5rem;">취소</button>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>

